// ÐšÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚ Ñ€ÐµÐ½Ð´ÐµÑ€Ð¸Ñ‚ÑŒ Ð¼Ð¾Ð´Ð°Ð»ÑŒÐ½Ðµ Ð²Ñ–ÐºÐ½Ð¾ Ð· Ð¿Ð¾Ð²Ð½Ð¸Ð¼ Ð¾Ð¿Ð¸ÑÐ¾Ð¼ Ð²Ñ–Ð´Ð¿Ð¾Ð²Ñ–Ð´Ð½Ð¾Ð³Ð¾ Ð¾Ð³Ð¾Ð»Ð¾ÑˆÐµÐ½Ð½Ñ Ñ‚Ð° ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ð°Ð¼Ð¸ AddToFavorite Ñ‚Ð° Contact
// Ð•Ð»ÐµÐ¼ÐµÐ½Ñ‚Ð¸ Ð· ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð½Ð¾ÑŽ Ñ–Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ñ–Ñ”ÑŽ (email,  Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½) Ð°Ð²Ñ‚Ð¾Ñ€Ð° Ð¾Ð³Ð¾Ð»Ð¾ÑˆÐµÐ½Ð½Ñ Ð¿Ð¾Ð²Ð¸Ð½Ð½Ñ– Ð±ÑƒÑ‚Ð¸ Ñ€ÐµÐ°Ð»Ñ–Ð·Ð¾Ð²Ð°Ð½Ñ– Ñƒ Ð²Ð¸Ð³Ð»ÑÐ´Ñ– Ð¿Ð¾ÑÐ¸Ð»Ð°Ð½ÑŒ Ð· Ð´Ð¾Ð´Ð°Ð²Ð°Ð½Ð½ÑÐ¼ ÐµÑ„ÐµÐºÑ‚Ñƒ :hover.                                                                                       ÐšÐ»Ñ–Ðº Ð¿Ð¾ ÐºÐ½Ð¾Ð¿Ñ†Ñ– AddToFavorite:
//         - ÑÐºÑ‰Ð¾ ÐºÐ¾Ñ€Ð¸ÑÑ‚ÑƒÐ²Ð°Ñ‡ ÐÐ’Ð¢ÐžÐ Ð˜Ð—ÐžÐ’ÐÐÐ˜Ð™ - Ð² Ð·Ð°Ð»ÐµÐ¶Ð½Ð¾ÑÑ‚Ñ– Ð²Ñ–Ð´ Ñ‚Ð¾Ð³Ð¾, Ñ‡Ð¸ Ð´Ð¾Ð´Ð°Ð½Ð¾ Ð²Ñ–Ð´Ð¿Ð¾Ð²Ñ–Ð´Ð½Ðµ Ð¾Ð³Ð¾Ð»Ð¾ÑˆÐµÐ½Ð½Ñ Ð² Ð¾Ð±Ñ€Ð°Ð½Ñ–, Ð¿Ð¾ ÐºÐ»Ñ–ÐºÑƒ ÐºÐ¾Ñ€Ð¸ÑÑ‚ÑƒÐ²Ð°Ñ‡ Ð´Ð¾Ð´Ð°Ñ” Ð¾Ð³Ð¾Ð»Ð¾ÑˆÐµÐ½Ð½Ñ Ð² Ð¾Ð±Ñ€Ð°Ð½Ñ– Ð°Ð±Ð¾ Ð²Ð¸Ð´Ð°Ð»ÑÑ” Ð· Ð½Ð¸Ñ…
//         - ÑÐºÑ‰Ð¾ ÐºÐ¾Ñ€Ð¸ÑÑ‚ÑƒÐ²Ð°Ñ‡ ÐÐ•ÐÐ’Ð¢ÐžÐ Ð˜Ð—ÐžÐ’ÐÐÐ˜Ð™, ÐºÐ¾Ñ€Ð¸ÑÑ‚ÑƒÐ²Ð°Ñ‡Ñƒ Ð¿Ð¾Ð²Ð¸Ð½Ð½Ð¾ Ð²Ð¸Ð²Ð¾Ð´Ð¸Ñ‚ÑŒÑÑŒ Ð¿Ð¾Ð²Ñ–Ð´Ð¾Ð¼Ð»ÐµÐ½Ð½Ñ Ñ‚Ð¸Ð¿Ñƒ Ð½Ð¾Ñ‚Ñ–Ñ„Ñ–ÐºÐ°Ñ†Ñ–Ñ Ð· Ñ–Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ñ–Ñ”ÑŽ Ð¿Ñ€Ð¾ Ñ‚Ðµ, Ñ‰Ð¾ ÐºÐ¾Ñ€Ð¸ÑÑ‚ÑƒÐ²Ð°Ñ‡Ñƒ Ð¿Ð¾Ñ‚Ñ€Ñ–Ð±Ð½Ð¾ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·ÑƒÐ²Ð°Ñ‚Ð¸ÑÑ Ð´Ð»Ñ Ð²Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð°Ð½Ð½Ñ Ð´Ð°Ð½Ð¾Ð³Ð¾ Ñ„ÑƒÐ½ÐºÑ†Ñ–Ð¾Ð½Ð°Ð»Ñƒ
// ÐšÐ½Ð¾Ð¿ÐºÐ° Contact Ð¿Ð¾Ð²Ð¸Ð½Ð½Ð° Ð±ÑƒÑ‚Ð¸ Ñ€ÐµÐ°Ð»Ñ–Ð·Ð¾Ð²Ð°Ð½Ð° ÑÐº Ð¿Ð¾ÑÐ¸Ð»Ð°Ð½Ð½Ñ, Ð¿Ñ€Ð¸ Ð½Ð°Ñ‚Ð¸ÑÐºÐ°Ð½Ð½Ñ– Ð½Ð° ÑÐºÑƒ ÐºÐ¾Ñ€Ð¸ÑÑ‚ÑƒÐ²Ð°Ñ‡Ð° Ð¿Ð¾Ð²Ð¸Ð½Ð½Ð¾ Ð¿ÐµÑ€ÐµÐ°Ð´Ñ€ÐµÑÑƒÐ²Ð°Ñ‚Ð¸ ÐºÐ¾Ñ€Ð¸ÑÑ‚ÑƒÐ²Ð°Ñ‡Ð° Ð½Ð° Ð¼Ð¾Ð±Ñ–Ð»ÑŒÐ½Ð¸Ð¹ Ð¿Ñ€Ð¸ÑÑ‚Ñ€Ñ–Ð¹ Ð´Ð»Ñ Ð²Ð¸ÐºÐ¾Ð½Ð°Ð½Ð½Ñ Ñ‚ÐµÐ»ÐµÑ„Ð¾Ð½Ð½Ð¾Ð³Ð¾ Ð´Ð·Ð²Ñ–Ð½ÐºÐ° Ð¿Ð¾ Ð½Ð¾Ð¼ÐµÑ€Ñƒ ÐºÐ¾Ñ€Ð¸ÑÑ‚ÑƒÐ²Ð°Ñ‡Ð°, Ñ‰Ð¾ ÑÑ‚Ð²Ð¾Ñ€Ð¸Ð² Ð¾Ð³Ð¾Ð»Ð¾ÑˆÐµÐ½Ð½Ñ
// ÐœÐ¾Ð´Ð°Ð»ÐºÐ° Ð¿Ð¾Ð²Ð¸Ð½Ð½Ð° Ð·Ð°ÐºÑ€Ð¸Ð²Ð°Ñ‚Ð¸ÑÑŒ Ð¿Ð¾ ÐºÐ»Ñ–ÐºÑƒ Ð½Ð° ÐºÐ½Ð¾Ð¿ÐºÑƒ Ð·Ð°ÐºÑ€Ð¸Ñ‚Ñ‚Ñ Ð¼Ð¾Ð´Ð°Ð»ÐºÐ¸, ÐºÐ»Ñ–Ðº Ð¿Ð¾ Ð±ÐµÐºÐ´Ñ€Ð¾Ð¿Ñƒ, Ð° Ñ‚Ð°ÐºÐ¾Ð¶ ÐºÐ»Ñ–Ðº Ð¿Ð¾ Escape

import PropTypes from 'prop-types';
import icons from '../../images/icons.svg';
import { ModalApproveAction } from 'components/ModalApproveAction/ModalApproveAction';
import {
  Button,
  ButtonWrap,
  ButtonWrapThumb,
  CategoryTag,
  CommentWrap,
  Contact,
  ContactBlur,
  ContactBtn,
  HeartIcon,
  Image,
  ImageWrapper,
  ItemProp,
  ListContact,
  ListProperty,
  ModalContent,
  NameProp,
  Price,
  PriceValue,
  PriceWrap,
  SignProp,
  TitleModal,
} from './ModalNotice.styled';
import { useDispatch, useSelector } from 'react-redux';
import { useEffect, useState } from 'react';
import { fetchNotice, updateFavorite } from 'Redux/notices/operation';
import { getIsLoadNotice, getNotice, selectFavorites } from 'Redux/notices/selector';
import { selectUser } from 'Redux/auth/selector';

export const ModalNotice = ({ onClose, noticeId }) => {
  const [withoutBlur, setWithoutBlur] = useState(0);
  // const [isFavorite, setIsFavirite] = useState(false);
  // console.log(withoutBlur);

  // const handleFavorite = () => {
  //   setIsFavirite(isFavorite => !isFavorite);

  //   if (!isFavorite) {
  //     console.log('Favirite true');
  //     console.log(isFavorite);
  //     toast.success('Pet has been added to favorites!', {
  //       style: {
  //         backgroundColor: '#fef9f9',
  //         padding: '6px',
  //         color: `'#111111'`,
  //       },
  //       icon: 'ðŸ’—',
  //     });
  //   } else {
  //     console.log('Favirite false');
  //     console.log(isFavorite);
  //     toast.success('Pet has been removed from favorites!', {
  //       style: {
  //         backgroundColor: '#fef9f9',
  //         padding: '6px',
  //         color: `'#111111'`,
  //       },
  //       icon: 'ðŸ˜¿',
  //     });
  //   }
  // };

  const handleBlurContacts = () => {
    setWithoutBlur(withoutBlur + 1);
  };

  const dispatch = useDispatch();
  const {
    imageURL,
    categories,
    name,
    birthday,
    breed,
    place,
    sex,
    comments,
    price,
  } = useSelector(getNotice);
  const isLoading = useSelector(getIsLoadNotice);

  const inUsersFavorites = useSelector(selectFavorites);
  console.log(inUsersFavorites);

  const userId = useSelector(selectUser).id
  console.log(userId)

  // const userId = '646f0e3366cea3f192faca83'

  const isFavorite = inUsersFavorites.includes(userId)
  console.log(isFavorite)

  useEffect(() => {
    dispatch(fetchNotice(noticeId));
  }, [dispatch, noticeId]);

  const handleFavorite = () => {
        dispatch(updateFavorite({noticeId, userId}));
  };

  return (
    <>
      <ModalApproveAction onClose={onClose} width>
        {isLoading ? (
          <h3>Loading...</h3>
        ) : (
          <ModalContent>
            <ImageWrapper>
              <Image
                alt="pet.name"
                src={
                  imageURL
                    ? imageURL
                    : 'https://encrypted-tbn1.gstatic.com/images?q=tbn:ANd9GcSgGi3YJI2iukoOZ3_fbYCyoiR4dYO8fIyIu_qpphSUf8GRAmFN'
                }
              />
              <CategoryTag>
                {categories ? categories : 'categories'}
              </CategoryTag>
            </ImageWrapper>
            <div>
              <div>
                <TitleModal>Cute pet looking for a home</TitleModal>
              </div>
              <ListProperty>
                <ItemProp>
                  <NameProp>Name:</NameProp>
                  <SignProp>{name ? name : 'Pet'}</SignProp>
                </ItemProp>
                <ItemProp>
                  <NameProp>Birthday:</NameProp>
                  <SignProp>{birthday ? birthday : 'find'}</SignProp>
                </ItemProp>
                <ItemProp>
                  <NameProp>NameBreed:</NameProp>
                  <SignProp>{breed ? breed : 'superior'}</SignProp>
                </ItemProp>
                <ItemProp>
                  <NameProp>Place:</NameProp>
                  <SignProp>{place ? place : 'find'}</SignProp>
                </ItemProp>
                <ItemProp>
                  <NameProp>The sex:</NameProp>
                  <SignProp>{sex ? sex : 'sex'}</SignProp>
                </ItemProp>
              </ListProperty>
              <ListContact>
                <ItemProp>
                  <NameProp>Email:</NameProp>
                  {!withoutBlur ? (
                    <ContactBlur href="mailto:user@mail.com">
                      user@mail.com
                    </ContactBlur>
                  ) : (
                    <Contact href="mailto:user@mail.com">user@mail.com</Contact>
                  )}
                </ItemProp>
                <ItemProp>
                  <NameProp>Phone:</NameProp>
                  {!withoutBlur ? (
                    <ContactBlur href="tel:+380971234567" aria-label="phone">
                      +380971234567
                    </ContactBlur>
                  ) : (
                    <Contact href="tel:+380971234567" aria-label="phone">
                      +380971234567
                    </Contact>
                  )}
                </ItemProp>
              </ListContact>
            </div>
            {/* <CommentWrap>
              <span>Comments:&nbsp;</span>
              <span>
                Rich would be the perfect addition to an active family that
                loves to play and go on walks. I bet he would love having a
                doggy playmate too!{' '}
              </span>
            </CommentWrap> */}
            {comments ? (
              <CommentWrap>
                <span>Comments:&nbsp;</span>
                <span>{comments}</span>
              </CommentWrap>
            ) : (
              <CommentWrap></CommentWrap>
            )}
            {/* <PriceProp> <Price>Place:</Price>
                  <Value>{price ? price : 'invaluable'}</Value></PriceProp> */}
            <ButtonWrapThumb>
              {price ? (
                <PriceWrap price>
                  <Price>Price:</Price>
                  <PriceValue>{price}</PriceValue>
                </PriceWrap>
              ) : (
                <PriceWrap>
                  <Price></Price>
                  <PriceValue></PriceValue>
                </PriceWrap>
              )}
              <ButtonWrap>
                {/* <ContactBtn href="tel:+380971234567" aria-label="phone button"> */}
                <ContactBtn
                  type="button"
                  aria-label="show contact button"
                  onClick={handleBlurContacts}
                >
                  Contact
                </ContactBtn>
                <Button
                  type="button"
                  aria-label="Add to favorite"
                  onClick={handleFavorite}
                >
                  Add to
                  <HeartIcon>
                    <use href={icons + '#heart'}></use>
                  </HeartIcon>
                </Button>
              </ButtonWrap>
            </ButtonWrapThumb>
          </ModalContent>
        )}
      </ModalApproveAction>
    </>
  );
};

ModalNotice.propTypes = {
  onClose: PropTypes.func.isRequired,
};
